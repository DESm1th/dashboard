<div id="delete-modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          <i class="fas fa-times"></i>
        </button>
        <h4>Delete database records?</h4>
      </div>
      <div class="modal-body">
        <p><span style="color: red;"><strong>WARNING: </strong></span>
          <span id="delete-message"></span>
          <div style="text-align: center;">Continue?</div>
        </p>
      </div>
      <div class="modal-footer">
        <a type="button" id="delete-submit" class="btn btn-primary pull-left"
            href="#">
          Delete
        </a>
        <button type="button" class="btn btn-default" data-dismiss="modal">
          Cancel
        </button>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">

function updateDeleteModal(session_num) {
  var name = "{{ timepoint.name }}";
  var warningBox = $("#delete-message");
  var submitButton = $("#delete-submit");
  if (session_num) {
    var message = "Session " + session_num + " from " + name +
      " will be deleted and everything associated with it will be purged " +
      "from the database (i.e. all scans, blacklist comments, metrics, etc.). " +
      "Everything except comments will be regenerated if the data is left on " +
      "the filesystem.";
    var destURL = "{{ url_for('timepoint', study_id=study_id, timepoint_id=timepoint.name) }}/delete_session/" +
        session_num;
  } else {
    var message = name + " and all of its sessions will be deleted. " +
      "Everything associated with this ID will be purged from the database. " +
      "If the original data is left on the filesystem it will be re-added " +
      "later, but any associated comments will disappear forever.";
    var destURL = "{{ url_for('delete_timepoint', study_id=study_id, timepoint_id=timepoint.name)}}";
  }
  warningBox.text(message);
  submitButton.attr("href", destURL);
}

// updateDeleteModal is wrapped in a function to ensure session_num isnt set by the browser
$("#delete-timepoint").on('click', function () {updateDeleteModal()});

$(".delete-session").on('click', function() {
  var session = this.getAttribute('data-session');
  updateDeleteModal(session);
});

</script>
